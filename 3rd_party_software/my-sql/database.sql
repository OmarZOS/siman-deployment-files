-- MySQL Script generated by MySQL Workbench
-- Mi 28 Jun 2023 16:46:04 CEST
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema Archive
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `Archive` ;

-- -----------------------------------------------------
-- Schema Archive
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `Archive` ;
USE `Archive` ;

-- -----------------------------------------------------
-- Table `Archive`.`Domain_Organisation`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Domain_Organisation` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Domain_Organisation` (
  `idDomain_Organisation` INT NOT NULL AUTO_INCREMENT,
  `Domain_Organisation_label_fr` VARCHAR(45) NULL,
  `Domain_Organisation_label_ar` VARCHAR(45) NULL,
  `Domain_Organisation_acronym_fr` VARCHAR(45) NULL,
  `Domain_Organisation_acronym_ar` VARCHAR(45) NULL,
  PRIMARY KEY (`idDomain_Organisation`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Region`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Region` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Region` (
  `idRegion` INT NOT NULL AUTO_INCREMENT,
  `region_label_fr` VARCHAR(45) NULL,
  `region_label_ar` VARCHAR(45) NULL,
  `region_acronym_fr` VARCHAR(45) NULL,
  `region_acronym_ar` VARCHAR(45) NULL,
  PRIMARY KEY (`idRegion`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Sector`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Sector` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Sector` (
  `idSector` INT NOT NULL AUTO_INCREMENT,
  `label_sector_fr` VARCHAR(45) NULL,
  `label_sector_ar` VARCHAR(45) NULL,
  `acronym_sector_fr` VARCHAR(45) NULL,
  `acronym_sector_ar` VARCHAR(45) NULL,
  `region_ref_id` INT NULL,
  PRIMARY KEY (`idSector`),
  INDEX `fk_Sector_1_idx` (`region_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Sector_1`
    FOREIGN KEY (`region_ref_id`)
    REFERENCES `Archive`.`Region` (`idRegion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Organisation`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Organisation` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Organisation` (
  `id_Organisation` INT NOT NULL AUTO_INCREMENT,
  `Organisation_name_ar` VARCHAR(255) NULL,
  `Organisation_name_fr` VARCHAR(255) NULL,
  `ACRONYM_AR` VARCHAR(45) NULL,
  `ACRONYM_FR` VARCHAR(45) NULL,
  `Organisation_domain_id_ref` INT NULL,
  `sector_ref_id` INT NULL,
  PRIMARY KEY (`id_Organisation`),
  INDEX `fk_Organisation_1_idx` (`Organisation_domain_id_ref` ASC) VISIBLE,
  INDEX `fk_Organisation_2_idx` (`sector_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Organisation_1`
    FOREIGN KEY (`Organisation_domain_id_ref`)
    REFERENCES `Archive`.`Domain_Organisation` (`idDomain_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Organisation_2`
    FOREIGN KEY (`sector_ref_id`)
    REFERENCES `Archive`.`Sector` (`idSector`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`doc_reference`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`doc_reference` ;

CREATE TABLE IF NOT EXISTS `Archive`.`doc_reference` (
  `reference_id` INT NOT NULL AUTO_INCREMENT,
  `reference_year` INT NULL,
  `reference_ar` VARCHAR(45) NULL,
  `reference_fr` VARCHAR(45) NULL,
  `Organisation_id_Organisation` INT NULL,
  PRIMARY KEY (`reference_id`),
  INDEX `fk_doc_reference_Organisation1_idx` (`Organisation_id_Organisation` ASC) VISIBLE,
  UNIQUE INDEX `Organisation_id_Organisation_UNIQUE` (`Organisation_id_Organisation` ASC) VISIBLE,
  CONSTRAINT `fk_doc_reference_Organisation1`
    FOREIGN KEY (`Organisation_id_Organisation`)
    REFERENCES `Archive`.`Organisation` (`id_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Container`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Container` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Container` (
  `idContainer` INT NOT NULL AUTO_INCREMENT,
  `type_container` VARCHAR(45) NULL,
  PRIMARY KEY (`idContainer`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`profile_rank`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`profile_rank` ;

CREATE TABLE IF NOT EXISTS `Archive`.`profile_rank` (
  `idprofile_rank` INT NOT NULL AUTO_INCREMENT,
  `profile_rank_label_fr` VARCHAR(45) NULL,
  `profile_rank_label_ar` VARCHAR(45) NULL,
  `profile_rank_acronym_fr` VARCHAR(45) NULL,
  `profile_rank_acronym_ar` VARCHAR(45) NULL,
  PRIMARY KEY (`idprofile_rank`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Profile`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Profile` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Profile` (
  `idProfile` INT NOT NULL AUTO_INCREMENT,
  `Profile_serial` VARCHAR(45) NULL,
  `Profile_rank_id_ref` INT NULL,
  `Profile_position_org` INT NULL,
  `Profile_domain_id_ref` INT NULL,
  PRIMARY KEY (`idProfile`),
  INDEX `fk_Profile_1_idx` (`Profile_rank_id_ref` ASC) VISIBLE,
  INDEX `fk_Profile_2_idx` (`Profile_position_org` ASC) VISIBLE,
  INDEX `fk_Profile_3_idx` (`Profile_domain_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `Profile_rank_id_ref_UNIQUE` (`Profile_rank_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `Profile_position_org_UNIQUE` (`Profile_position_org` ASC) VISIBLE,
  UNIQUE INDEX `Profile_domain_id_ref_UNIQUE` (`Profile_domain_id_ref` ASC) VISIBLE,
  CONSTRAINT `fk_Profile_1`
    FOREIGN KEY (`Profile_rank_id_ref`)
    REFERENCES `Archive`.`profile_rank` (`idprofile_rank`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Profile_2`
    FOREIGN KEY (`Profile_position_org`)
    REFERENCES `Archive`.`Organisation` (`id_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Profile_3`
    FOREIGN KEY (`Profile_domain_id_ref`)
    REFERENCES `Archive`.`Domain_Organisation` (`idDomain_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Person`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Person` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Person` (
  `PERSON_ID` INT NOT NULL AUTO_INCREMENT,
  `Person_name` VARCHAR(45) NULL,
  `Person_lastname` VARCHAR(45) NULL,
  `Person_profile_id_ref` INT NULL,
  PRIMARY KEY (`PERSON_ID`),
  INDEX `fk_Person_1_idx` (`Person_profile_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `Person_profile_id_ref_UNIQUE` (`Person_profile_id_ref` ASC) VISIBLE,
  CONSTRAINT `fk_Person_1`
    FOREIGN KEY (`Person_profile_id_ref`)
    REFERENCES `Archive`.`Profile` (`idProfile`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`User`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`User` ;

CREATE TABLE IF NOT EXISTS `Archive`.`User` (
  `USER_ID` INT NOT NULL AUTO_INCREMENT,
  `USER_NAME` VARCHAR(45) NULL,
  `USER_PASSWORD` VARCHAR(255) NULL,
  `Person_ID` INT NULL,
  `admin_privilege` TINYINT NULL,
  PRIMARY KEY (`USER_ID`),
  INDEX `fk_User_Person_idx` (`Person_ID` ASC) VISIBLE,
  UNIQUE INDEX `Person_ID_UNIQUE` (`Person_ID` ASC) VISIBLE,
  CONSTRAINT `fk_User_Person`
    FOREIGN KEY (`Person_ID`)
    REFERENCES `Archive`.`Person` (`PERSON_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Document`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Document` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Document` (
  `Doc_ID` INT NOT NULL AUTO_INCREMENT,
  `Doc_Label` VARCHAR(255) NULL,
  `Doc_size` BIGINT NULL,
  `Doc_number_of_chunks` SMALLINT NULL,
  `reference_id` INT NOT NULL,
  `USER_ID` INT NULL,
  `Doc_chunk_number` SMALLINT NULL,
  `Documentcol` INT NULL,
  `container_ref_id` INT NULL,
  `added_by_user_id_ref` INT NULL,
  PRIMARY KEY (`Doc_ID`, `reference_id`),
  INDEX `fk_Document_User1_idx` (`container_ref_id` ASC) VISIBLE,
  INDEX `fk_Document_reference1_idx` (`reference_id` ASC) VISIBLE,
  INDEX `fk_Document_1_idx` (`added_by_user_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `added_by_user_id_ref_UNIQUE` (`added_by_user_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `container_ref_id_UNIQUE` (`container_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Document_reference1`
    FOREIGN KEY (`reference_id`)
    REFERENCES `Archive`.`doc_reference` (`reference_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Document_User1`
    FOREIGN KEY (`container_ref_id`)
    REFERENCES `Archive`.`Container` (`idContainer`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Document_1`
    FOREIGN KEY (`added_by_user_id_ref`)
    REFERENCES `Archive`.`User` (`USER_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Document_chunk`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Document_chunk` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Document_chunk` (
  `idChunk` INT NOT NULL AUTO_INCREMENT,
  `Document_Doc_ID` INT NOT NULL,
  `Document_chunk_data` BLOB NULL,
  PRIMARY KEY (`idChunk`, `Document_Doc_ID`),
  INDEX `fk_Document_chunk_Document1_idx` (`Document_Doc_ID` ASC) VISIBLE,
  CONSTRAINT `fk_Document_chunk_Document1`
    FOREIGN KEY (`Document_Doc_ID`)
    REFERENCES `Archive`.`Document` (`Doc_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Transcript`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Transcript` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Transcript` (
  `idTranscript` INT NOT NULL AUTO_INCREMENT,
  `reference_transcript` VARCHAR(45) NULL,
  PRIMARY KEY (`idTranscript`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Document_type`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Document_type` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Document_type` (
  `idDocument_type` INT NOT NULL AUTO_INCREMENT,
  `document_type_label_fr` VARCHAR(45) NULL,
  `document_type_label_ar` VARCHAR(45) NULL,
  PRIMARY KEY (`idDocument_type`),
  UNIQUE INDEX `document_type_label_fr_UNIQUE` (`document_type_label_fr` ASC) VISIBLE,
  UNIQUE INDEX `document_type_label_ar_UNIQUE` (`document_type_label_ar` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Elimination`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Elimination` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Elimination` (
  `idElimination` INT NOT NULL AUTO_INCREMENT,
  `max_eliminated_date` DATE NULL,
  `min_eliminated_date` DATE NULL,
  `id_transcript` INT NOT NULL,
  `doc_type_ref` INT NOT NULL,
  `elimination_container_ref_id` INT NOT NULL,
  PRIMARY KEY (`idElimination`, `id_transcript`, `doc_type_ref`),
  INDEX `fk_Elimination_1_idx` (`doc_type_ref` ASC) VISIBLE,
  INDEX `fk_Elimination_2_idx` (`elimination_container_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `id_transcript_UNIQUE` (`id_transcript` ASC) VISIBLE,
  UNIQUE INDEX `doc_type_ref_UNIQUE` (`doc_type_ref` ASC) VISIBLE,
  UNIQUE INDEX `elimination_container_ref_id_UNIQUE` (`elimination_container_ref_id` ASC) VISIBLE,
  CONSTRAINT `id_ref_transcript`
    FOREIGN KEY (`id_transcript`)
    REFERENCES `Archive`.`Transcript` (`idTranscript`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Elimination_1`
    FOREIGN KEY (`doc_type_ref`)
    REFERENCES `Archive`.`Document_type` (`idDocument_type`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Elimination_2`
    FOREIGN KEY (`elimination_container_ref_id`)
    REFERENCES `Archive`.`Container` (`idContainer`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Communication_demand`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Communication_demand` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Communication_demand` (
  `idCommunication_demand` INT NOT NULL AUTO_INCREMENT,
  `Communication_demanding_org_ref_id` INT NULL,
  PRIMARY KEY (`idCommunication_demand`),
  INDEX `fk_Communication_demand_1_idx` (`Communication_demanding_org_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Communication_demanding_org_ref_id_UNIQUE` (`Communication_demanding_org_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Communication_demand_1`
    FOREIGN KEY (`Communication_demanding_org_ref_id`)
    REFERENCES `Archive`.`Organisation` (`id_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Transfer`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Transfer` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Transfer` (
  `idTransfer` INT NOT NULL AUTO_INCREMENT,
  `source_organisation_id_ref` INT NULL,
  `destination_organisation_id_ref` INT NULL,
  `container_ref_id` VARCHAR(45) NULL,
  PRIMARY KEY (`idTransfer`),
  INDEX `fk_Transfer_1_idx` (`source_organisation_id_ref` ASC) VISIBLE,
  INDEX `fk_Transfer_2_idx` (`destination_organisation_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `source_organisation_id_ref_UNIQUE` (`source_organisation_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `destination_organisation_id_ref_UNIQUE` (`destination_organisation_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `container_ref_id_UNIQUE` (`container_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Transfer_1`
    FOREIGN KEY (`source_organisation_id_ref`)
    REFERENCES `Archive`.`Organisation` (`id_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Transfer_2`
    FOREIGN KEY (`destination_organisation_id_ref`)
    REFERENCES `Archive`.`Organisation` (`id_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`document_type_belongings`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`document_type_belongings` ;

CREATE TABLE IF NOT EXISTS `Archive`.`document_type_belongings` (
  `iddocument_type_belongings` INT NOT NULL AUTO_INCREMENT,
  `belonging_domain_id_ref` INT NULL,
  `belonging_type_id_ref` INT NULL,
  `belonging_code` VARCHAR(45) NULL,
  PRIMARY KEY (`iddocument_type_belongings`),
  INDEX `fk_document_type_belongings_1_idx` (`belonging_type_id_ref` ASC) VISIBLE,
  INDEX `fk_document_type_belongings_2_idx` (`belonging_domain_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `belonging_domain_id_ref_UNIQUE` (`belonging_domain_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `belonging_type_id_ref_UNIQUE` (`belonging_type_id_ref` ASC) VISIBLE,
  CONSTRAINT `fk_document_type_belongings_1`
    FOREIGN KEY (`belonging_type_id_ref`)
    REFERENCES `Archive`.`Document_type` (`idDocument_type`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_document_type_belongings_2`
    FOREIGN KEY (`belonging_domain_id_ref`)
    REFERENCES `Archive`.`Domain_Organisation` (`idDomain_Organisation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`session`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`session` ;

CREATE TABLE IF NOT EXISTS `Archive`.`session` (
  `idsession` INT NOT NULL AUTO_INCREMENT,
  `session_start_date` DATE NULL,
  `session_end_date` DATE NULL,
  PRIMARY KEY (`idsession`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`trainee`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`trainee` ;

CREATE TABLE IF NOT EXISTS `Archive`.`trainee` (
  `idtrainee` INT NOT NULL AUTO_INCREMENT,
  `profile_ref_id` INT NULL,
  `session_ref_id` INT NULL,
  `trainee_mark` VARCHAR(45) NULL,
  `trainee_evaluation` VARCHAR(45) NULL,
  PRIMARY KEY (`idtrainee`),
  INDEX `fk_trainee_1_idx` (`profile_ref_id` ASC) VISIBLE,
  INDEX `fk_trainee_2_idx` (`session_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `profile_ref_id_UNIQUE` (`profile_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `session_ref_id_UNIQUE` (`session_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_trainee_1`
    FOREIGN KEY (`profile_ref_id`)
    REFERENCES `Archive`.`Profile` (`idProfile`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_trainee_2`
    FOREIGN KEY (`session_ref_id`)
    REFERENCES `Archive`.`session` (`idsession`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Store`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Store` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Store` (
  `idStore` INT NOT NULL AUTO_INCREMENT,
  `Storetype` VARCHAR(45) NULL,
  `store_label_fr` VARCHAR(45) NULL,
  `store_label_ar` VARCHAR(45) NULL,
  `store_acronym_fr` VARCHAR(45) NULL,
  `store_acronym_ar` VARCHAR(45) NULL,
  PRIMARY KEY (`idStore`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Bay`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Bay` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Bay` (
  `idBay` INT NOT NULL AUTO_INCREMENT,
  `Bay_number` INT NULL,
  PRIMARY KEY (`idBay`),
  INDEX `fk_Bay_1_idx` (`Bay_number` ASC) VISIBLE,
  UNIQUE INDEX `Bay_number_UNIQUE` (`Bay_number` ASC) VISIBLE,
  CONSTRAINT `fk_Bay_1`
    FOREIGN KEY (`Bay_number`)
    REFERENCES `Archive`.`Store` (`idStore`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Cob`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Cob` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Cob` (
  `idCob` INT NOT NULL AUTO_INCREMENT,
  `Cob_id_ref` INT NULL,
  PRIMARY KEY (`idCob`),
  INDEX `fk_Cob_1_idx` (`Cob_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `Cob_id_ref_UNIQUE` (`Cob_id_ref` ASC) VISIBLE,
  CONSTRAINT `fk_Cob_1`
    FOREIGN KEY (`Cob_id_ref`)
    REFERENCES `Archive`.`Bay` (`idBay`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Shelf`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Shelf` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Shelf` (
  `idShelf` INT NOT NULL AUTO_INCREMENT,
  `Shelf_id_ref` INT NULL,
  PRIMARY KEY (`idShelf`),
  INDEX `fk_Shelf_1_idx` (`Shelf_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `Shelf_id_ref_UNIQUE` (`Shelf_id_ref` ASC) VISIBLE,
  CONSTRAINT `fk_Shelf_1`
    FOREIGN KEY (`Shelf_id_ref`)
    REFERENCES `Archive`.`Cob` (`idCob`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Cabinet`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Cabinet` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Cabinet` (
  `idCabinet` INT NOT NULL AUTO_INCREMENT,
  `Cabinet_store_ref_id` INT NULL,
  PRIMARY KEY (`idCabinet`),
  INDEX `fk_Cabinet_1_idx` (`Cabinet_store_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Cabinet_store_ref_id_UNIQUE` (`Cabinet_store_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Cabinet_1`
    FOREIGN KEY (`Cabinet_store_ref_id`)
    REFERENCES `Archive`.`Store` (`idStore`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Container_position`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Container_position` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Container_position` (
  `idContainer_position` INT NOT NULL AUTO_INCREMENT,
  `Container_position_shelf_ref_id` INT NULL,
  `Container_position_cabinet_ref_id` INT NULL,
  PRIMARY KEY (`idContainer_position`),
  INDEX `fk_Container_position_1_idx` (`Container_position_shelf_ref_id` ASC) VISIBLE,
  INDEX `fk_Container_position_2_idx` (`Container_position_cabinet_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Container_position_shelf_ref_id_UNIQUE` (`Container_position_shelf_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Container_position_cabinet_ref_id_UNIQUE` (`Container_position_cabinet_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Container_position_1`
    FOREIGN KEY (`Container_position_shelf_ref_id`)
    REFERENCES `Archive`.`Shelf` (`idShelf`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Container_position_2`
    FOREIGN KEY (`Container_position_cabinet_ref_id`)
    REFERENCES `Archive`.`Cabinet` (`idCabinet`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Contained_types`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Contained_types` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Contained_types` (
  `idContained_types` INT NOT NULL AUTO_INCREMENT,
  `container_type_ref_id` INT NULL,
  `types_contained_ref_id` INT NULL,
  `Container_position_ref_id` INT NULL,
  PRIMARY KEY (`idContained_types`),
  INDEX `fk_Contained_types_1_idx` (`container_type_ref_id` ASC) VISIBLE,
  INDEX `fk_Contained_types_2_idx` (`types_contained_ref_id` ASC) VISIBLE,
  INDEX `fk_Contained_types_3_idx` (`Container_position_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `types_contained_ref_id_UNIQUE` (`types_contained_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `container_type_ref_id_UNIQUE` (`container_type_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Container_position_ref_id_UNIQUE` (`Container_position_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Contained_types_1`
    FOREIGN KEY (`container_type_ref_id`)
    REFERENCES `Archive`.`Container` (`idContainer`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Contained_types_2`
    FOREIGN KEY (`types_contained_ref_id`)
    REFERENCES `Archive`.`Document_type` (`idDocument_type`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Contained_types_3`
    FOREIGN KEY (`Container_position_ref_id`)
    REFERENCES `Archive`.`Container_position` (`idContainer_position`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Communication_response`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Communication_response` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Communication_response` (
  `idCommunication_response` INT NOT NULL AUTO_INCREMENT,
  `Communication_demand_ref_id` INT NULL,
  PRIMARY KEY (`idCommunication_response`),
  INDEX `fk_Communication_response_1_idx` (`Communication_demand_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Communication_demand_ref_id_UNIQUE` (`Communication_demand_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Communication_response_1`
    FOREIGN KEY (`Communication_demand_ref_id`)
    REFERENCES `Archive`.`Communication_demand` (`idCommunication_demand`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`Communication_subject`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`Communication_subject` ;

CREATE TABLE IF NOT EXISTS `Archive`.`Communication_subject` (
  `idCommunication_subject` INT NOT NULL AUTO_INCREMENT,
  `Communicated_doc_ref_id` INT NULL,
  `Communication_response_ref_id` INT NULL,
  PRIMARY KEY (`idCommunication_subject`),
  INDEX `fk_Communication_subject_1_idx` (`Communication_response_ref_id` ASC) VISIBLE,
  INDEX `fk_Communication_subject_2_idx` (`Communicated_doc_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Communicated_doc_ref_id_UNIQUE` (`Communicated_doc_ref_id` ASC) VISIBLE,
  UNIQUE INDEX `Communication_response_ref_id_UNIQUE` (`Communication_response_ref_id` ASC) VISIBLE,
  CONSTRAINT `fk_Communication_subject_1`
    FOREIGN KEY (`Communication_response_ref_id`)
    REFERENCES `Archive`.`Communication_response` (`idCommunication_response`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Communication_subject_2`
    FOREIGN KEY (`Communicated_doc_ref_id`)
    REFERENCES `Archive`.`Document` (`Doc_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Archive`.`transferred_contained_types`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Archive`.`transferred_contained_types` ;

CREATE TABLE IF NOT EXISTS `Archive`.`transferred_contained_types` (
  `idtransferred_contained_types` INT NOT NULL AUTO_INCREMENT,
  `transferred_contained_types_id_ref` INT NULL,
  `transferred_types_contained` INT NULL,
  INDEX `fk_transferred_contained_types_1_idx` (`transferred_types_contained` ASC) VISIBLE,
  INDEX `fk_transferred_contained_types_2_idx` (`transferred_contained_types_id_ref` ASC) VISIBLE,
  PRIMARY KEY (`idtransferred_contained_types`),
  UNIQUE INDEX `transferred_contained_types_id_ref_UNIQUE` (`transferred_contained_types_id_ref` ASC) VISIBLE,
  UNIQUE INDEX `transferred_types_contained_UNIQUE` (`transferred_types_contained` ASC) VISIBLE,
  CONSTRAINT `fk_transferred_contained_types_1`
    FOREIGN KEY (`transferred_types_contained`)
    REFERENCES `Archive`.`Contained_types` (`idContained_types`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_transferred_contained_types_2`
    FOREIGN KEY (`transferred_contained_types_id_ref`)
    REFERENCES `Archive`.`Transfer` (`idTransfer`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

USE `Archive` ;

-- -----------------------------------------------------
-- procedure InsertDataIntoMultipleTables
-- -----------------------------------------------------

USE `Archive`;
DROP procedure IF EXISTS `Archive`.`InsertDataIntoMultipleTables`;

DELIMITER $$
USE `Archive`$$
CREATE PROCEDURE InsertDataIntoMultipleTables (
    IN p_name VARCHAR(255),
    IN p_email VARCHAR(255),
    IN p_address VARCHAR(255)
)
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        ROLLBACK;
        SELECT 'An error occurred. Transaction rolled back.';
    END;

    START TRANSACTION;

    INSERT INTO table1 (name, email) VALUES (p_name, p_email);
    SET @last_id := LAST_INSERT_ID();

    INSERT INTO table2 (user_id, address) VALUES (@last_id, p_address);

    COMMIT;

    SELECT 'Data inserted successfully.';
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure GetEmployeeCount
-- -----------------------------------------------------

USE `Archive`;
DROP procedure IF EXISTS `Archive`.`GetEmployeeCount`;

DELIMITER $$
USE `Archive`$$
CREATE PROCEDURE GetEmployeeCount(IN departmentId INT, OUT employeeCount INT)
BEGIN
    SELECT COUNT(*) INTO employeeCount
    FROM employees
    WHERE department_id = departmentId;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure Trainee
-- -----------------------------------------------------

USE `Archive`;
DROP procedure IF EXISTS `Archive`.`Trainee`;

DELIMITER $$
USE `Archive`$$
CREATE PROCEDURE Trainee (
    IN p_name VARCHAR(255),
    IN p_email VARCHAR(255),
    IN p_address VARCHAR(255)
)
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        ROLLBACK;
        SELECT 'An error occurred. Transaction rolled back.';
    END;

    START TRANSACTION;

    INSERT INTO table1 (name, email) VALUES (p_name, p_email);
    SET @last_id := LAST_INSERT_ID();

    INSERT INTO table2 (user_id, address) VALUES (@last_id, p_address);

    COMMIT;

    SELECT 'Data inserted successfully.';
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure InsertTrainee
-- -----------------------------------------------------

USE `Archive`;
DROP procedure IF EXISTS `Archive`.`InsertTrainee`;

DELIMITER $$
USE `Archive`$$
CREATE PROCEDURE InsertTrainee (
    IN p_domain_id INT,
    IN p_org_id INT,
    IN p_region_id INT,
    IN p_sector_id INT,
    IN p_session_id INT,
    IN p_rank_id INT,
    IN p_lastname VARCHAR(45),
    IN p_name VARCHAR(45),
    IN p_serial VARCHAR(255),
    IN p_mark VARCHAR(45),
    IN p_evaluation VARCHAR(45)
)
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        ROLLBACK;
SELECT 'An error occurred. Transaction rolled back.';
    END;
    START TRANSACTION;
    INSERT INTO profile (Profile_serial,Profile_rank_id_ref,Profile_position_org,Profile_domain_id_ref) VALUES (p_name, p_rank_id,p_org_id,p_domain_id);
    SET @last_profile_id := LAST_INSERT_ID();
    INSERT INTO trainee (profile_ref_id, session_ref_id,trainee_mark,trainee_evaluation) VALUES (@last_profile_id, p_session_id,p_mark,p_evaluation);
	INSERT INTO Person (Person_profile_id_ref, Person_name,Person_lastname) VALUES (@last_profile_id, p_name,p_lastname);
    COMMIT;

SELECT 'Data inserted successfully.';
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure GetTraineeCountInSession
-- -----------------------------------------------------

USE `Archive`;
DROP procedure IF EXISTS `Archive`.`GetTraineeCountInSession`;

DELIMITER $$
USE `Archive`$$
CREATE PROCEDURE GetTraineeCountInSession(IN sessionId INT, OUT traineeCount INT)
BEGIN
    SELECT COUNT(*) INTO traineeCount
    FROM trainee
    WHERE sessionId = session_ref_id;
END$$

DELIMITER ;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
